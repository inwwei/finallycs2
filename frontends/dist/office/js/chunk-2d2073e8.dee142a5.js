(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d2073e8"],{a069:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"vx-row"},[a("div",{staticClass:"vx-col w-full md:w-1/1 lg:w-1/1 xl:w-1/1"},[a("panel",{attrs:{title:"แก้ไขข้อมูลสมาชิก"}},[a("br"),a("p",{staticClass:"ml-5"},[t._v("แก้ไขข้อมูลสมาชิก")]),a("br"),a("div",{staticClass:"flex mb-4 ml-5"},[a("form-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"`required`"}],attrs:{label:"ชื่อ-นามสกุล",col:3},model:{value:t.form.customer_name,callback:function(e){t.$set(t.form,"customer_name",e)},expression:"form.customer_name"}}),t._v("   \n          "),a("form-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"`required`"}],attrs:{label:"ที่อยู่",col:3},model:{value:t.form.customer_address,callback:function(e){t.$set(t.form,"customer_address",e)},expression:"form.customer_address"}}),t._v("\n             \n          "),a("form-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"`required`"}],attrs:{label:"สาขา",col:3},model:{value:t.form.customer_branch,callback:function(e){t.$set(t.form,"customer_branch",e)},expression:"form.customer_branch"}}),t._v("\n             \n\n          "),a("custom-tree-select",{staticClass:"my-5",attrs:{url:"/api/setting/master/customer",col:4},model:{value:t.form.setting_master_customer_id,callback:function(e){t.$set(t.form,"setting_master_customer_id",e)},expression:"form.setting_master_customer_id"}})],1),a("p",{staticClass:"ml-5"},[t._v("แนบไฟล์เอกสาร")]),a("div",{staticClass:"flex mb-4"},[a("div",[a("attached",{ref:"upload",attrs:{id:t.data_id,model:t.data_model}})],1)]),a("div",{staticClass:"vx-row"},[a("div",{staticClass:"vx-col sm:w-2/3 w-full ml-auto",attrs:{align:"right"}},[a("vs-button",{attrs:{color:"primary",type:"filled"},on:{click:function(e){return t.updateCustomer()}}},[t._v("ยืนยัน")]),t._v(" \n            "),a("vs-button",{attrs:{color:"danger",type:"filled",to:"/member/index"}},[t._v("ยกเลิก")])],1)]),t._v("\n        "+t._s(t.form.setting_id)+"\n      ")]),t.form.id?a("EditContactTable",{attrs:{id:t.form.id}}):t._e()],1)])])},s=[],n=(a("96cf"),a("3b8d")),i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"vx-row"},[a("div",{staticClass:"vx-col w-full md:w-1/1 lg:w-1/1 xl:w-1/1"},[a("div",{staticClass:"flex my-4"},[a("panel",{attrs:{title:"ติดต่อ"},scopedSlots:t._u([{key:"header-right",fn:function(){return[a("vs-button",{attrs:{color:"primary",type:"filled"},on:{click:function(e){return t.openAddContact()}}},[t._v("เพิ่ม")])]},proxy:!0}])},[a("div",{staticClass:"mt-5"},[a("div",[a("vs-table",{attrs:{"max-items":"3",pagination:"",search:"",data:t.tables},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.data;return t._l(r,(function(e,r){return a("vs-tr",{key:r},[a("vs-td",{attrs:{data:r}},[t._v("\n                    "+t._s(r+1)+"\n                  ")]),a("vs-td",{attrs:{data:e.value}},[t._v("\n                    "+t._s(e.value)+"\n                  ")]),a("vs-td",{attrs:{data:e.customer_contacts}},[t._v("\n                    "+t._s(e.type)+"\n                  ")]),a("vs-td",[a("div",{staticClass:"flex mb-3",attrs:{align:"center"}},[a("div",{staticClass:"w-1/6 bg-grid-color h-12"},[a("vs-button",{attrs:{delay:"10s",color:"primary",type:"flat","icon-pack":"feather",icon:"icon-edit"},on:{click:function(a){return t.openContact(e.id)}}})],1),a("div",{staticClass:"w-1/6 bg-grid-color h-12"},[a("vs-button",{attrs:{color:"danger",type:"flat","icon-pack":"feather",icon:"icon-trash"},on:{click:function(a){return t.deleteContact(e)}}})],1),a("div",{staticClass:"w-1/6 bg-grid-color-secondary h-12"})])])],1)}))}}])},[a("template",{slot:"header"},[a("h3",{staticClass:"px-2"},[t._v("ข้อมูลติดต่อ")])]),a("template",{slot:"thead"},[a("vs-th",[t._v(" ลำดับ")]),a("vs-th",[t._v(" ข้อมูลติดต่อ ")]),a("vs-th",[t._v(" ประเภท ")]),a("vs-th")],1)],2)],1)])])],1)]),a("vs-popup",{attrs:{classContent:"popup-example",title:"แก้ไขข้อมูลติดต่อ",active:t.popupEditContact},on:{"update:active":function(e){t.popupEditContact=e}}},[a("div",{staticClass:"flex mb-4",attrs:{align:"center"}},[a("div",{staticClass:"w-full bg-grid-color h-12"},[a("form-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"`required`"}],attrs:{label:"ข้อมูลติดต่อ",col:12},model:{value:t.edits.value,callback:function(e){t.$set(t.edits,"value",e)},expression:"edits.value"}})],1),t._v("\n        \n      "),a("div",{staticClass:"w-full bg-grid-color h-12"},[a("form-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"`required`"}],attrs:{label:"ประเภท",col:12},model:{value:t.edits.type,callback:function(e){t.$set(t.edits,"type",e)},expression:"edits.type"}})],1)]),a("br"),a("div",{staticClass:"vx-row"},[a("div",{staticClass:"flex mb-4"})]),a("div",{staticClass:"vx-row"},[a("div",{staticClass:"vx-col sm:w-2/3 w-full ml-auto",attrs:{align:"right"}},[a("vs-button",{attrs:{color:"primary",size:"medium",type:"filled"},on:{click:function(e){return t.updateContact()}}},[t._v("ยืนยัน")]),t._v(" \n        "),a("vs-button",{attrs:{color:"danger",size:"medium",type:"filled"},on:{click:function(e){t.popupEditContact=!1}}},[t._v("ยกเลิก")])],1)])]),a("vs-popup",{attrs:{classContent:"popup-example",title:"เพิ่ม ช่องทางการติดต่อ",active:t.popupAddContact},on:{"update:active":function(e){t.popupAddContact=e}}},[a("div",{staticClass:"flex mb-4",attrs:{align:"center"}},[a("div",{staticClass:"w-full bg-grid-color h-12"},[a("form-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"`required`"}],attrs:{label:"ช่องทางการติดต่อ:",col:12},model:{value:t.add.value,callback:function(e){t.$set(t.add,"value",e)},expression:"add.value"}})],1),t._v("\n        \n      "),a("div",{staticClass:"w-full bg-grid-color h-12"},[a("form-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"`required`"}],attrs:{label:"ประเภท:",col:12},model:{value:t.add.type,callback:function(e){t.$set(t.add,"type",e)},expression:"add.type"}})],1)]),a("div",{staticClass:"vx-row"},[a("div",{staticClass:"flex mb-4"})]),a("div",{staticClass:"vx-row"},[a("div",{staticClass:"vx-col sm:w-2/3 w-full ml-auto",attrs:{align:"right"}},[a("vs-button",{attrs:{color:"primary",size:"medium",type:"filled"},on:{click:function(e){return t.insertContact()}}},[t._v("ยืนยัน")]),t._v(" \n        "),a("vs-button",{attrs:{color:"danger",size:"medium",type:"filled"},on:{click:function(e){t.popupAddContact=!1}}},[t._v("ยกเลิก")])],1)])])],1)},c=[],o={name:"EditContactTable",props:{id:{default:"",type:String}},data:function(){return{data_id:"",data_model:"App\\Models\\CustomerContact",popupAddContact:!1,popupEditContact:!1,tables:[],edits:{},add:{value:"",type:""}}},methods:{openAddContact:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.popupAddContact=!0;case 1:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),openContact:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.$http.get("/api/customercontacts/".concat(this.id,"/").concat(e));case 3:a=t.sent,r=a.data.data,this.edits.id=r.id,this.edits.customer_id=r.customer_id,this.edits.value=r.value,this.edits.type=r.type,0===r.length&&console.log("empty edit Table"),t.next=15;break;case 12:throw t.prev=12,t.t0=t["catch"](0),t.t0;case 15:this.popupEditContact=!0;case 16:case"end":return t.stop()}}),t,this,[[0,12]])})));function e(e){return t.apply(this,arguments)}return e}(),loadDataTable:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.$http.get("/api/customers/".concat(this.id));case 3:e=t.sent,a=e.data,this.tables=a.data.customer_contacts,0===this.tables.length&&console.log("empty Contacts"),t.next=12;break;case 9:throw t.prev=9,t.t0=t["catch"](0),t.t0;case 12:case"end":return t.stop()}}),t,this,[[0,9]])})));function e(){return t.apply(this,arguments)}return e}(),acceptAlertFail:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.$vs.notify({color:"danger",title:"แก้ไขข้อมูลไม่สำเร็จ",text:"แก้ไขข้อมูลสมาชิกไม่สำเร็จ"});case 1:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),updateAlert:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$http.patch("/api/customercontacts/".concat(this.id,"/").concat(this.edits.id),this.edits);case 2:this.loadDataTable(),this.$vs.notify({color:"success",title:"แก้ไขข้อมูลสำเร็จ",text:"แก้ไขข้อมูลสมาชิกสำเร็จ"});case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),updateContact:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:try{this.popupEditContact=!1,this.$vs.dialog({type:"confirm",color:"success",title:"ต้องการเพิ่มข้อมูลหรือไม่",text:"กรุณาตรวจสอบการกรอกข้อมูลให้ครบถ้วน",acceptText:"ยืนยัน",cancelText:"ยกเลิก",accept:this.updateAlert})}catch(e){this.$vs.dialog({color:"danger",title:"เพิ่มข้อมูลไม่สำเร็จ",text:"กรุณาตรวจสอบการกรอกข้อมูลให้ครบถ้วน",acceptText:"ปิด"}),this.popupEditContact=!1}case 1:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),deleteContact:function(t){this.tableDelete=t,this.$vs.dialog({type:"confirm",color:"danger",title:"ต้องการลบรายการนี้หรือไม่ ?",acceptText:"ยืนยัน",cancelText:"ยกเลิก",text:"คุณแน่ใจหรือไม่ว่าต้องการลบ ".concat(this.tableDelete.value),accept:this.deleteAlert})},deleteAlert:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.$http.delete("/api/customercontacts/".concat(this.tableDelete.id,"/").concat(this.tableDelete.customer_id));case 3:return t.next=5,this.loadDataTable();case 5:t.next=9;break;case 7:t.prev=7,t.t0=t["catch"](0);case 9:this.$vs.notify({color:"success",title:"ลบสำเร็จ",text:"บันทึกข้อมูล"});case 10:case"end":return t.stop()}}),t,this,[[0,7]])})));function e(){return t.apply(this,arguments)}return e}(),acceptAlertAddContact:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$http.post("/api/customercontacts/".concat(this.id),{customer_id:this.id,insert_value:this.add.value,insert_type:this.add.type});case 2:this.loadDataTable(),this.$vs.notify({color:"success",title:"เพิ่มข้อมูลสำเร็จ",text:"เพิ่มข้อมูลสมาชิกสำเร็จ"});case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),insertContact:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:try{this.popupAddContact=!1,this.$vs.dialog({type:"confirm",color:"success",title:"ต้องการเพิ่มข้อมูลหรือไม่",text:"กรุณาตรวจสอบการกรอกข้อมูลให้ครบถ้วน",acceptText:"ยืนยัน",cancelText:"ยกเลิก",accept:this.acceptAlertAddContact}),this.loadDataTable()}catch(e){this.popupAddContact=!1,this.$vs.dialog({color:"danger",title:"เพิ่มข้อมูลไม่สำเร็จ",text:"กรุณาตรวจสอบการกรอกข้อมูลให้ครบถ้วน",acceptText:"ปิด"})}case 1:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},mounted:function(){this.loadDataTable()}},l=o,u=a("2877"),d=Object(u["a"])(l,i,c,!1,null,null,null),p=d.exports,m={components:{EditContactTable:p},data:function(){return{data_id:"",data_model:"App\\Models\\Customer",popupAddContact:!1,popupEditContact:!1,form:{id:"",code:"12345",customer_name:"",customer_address:"",customer_contacts:"",customer_branch:"",setting_master_customer_id:"",type:""},tables:[],edits:{},add:{value:"",type:""}}},methods:{loadData:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.$http.get("/api/customers/".concat(this.form.id));case 3:e=t.sent,a=e.data.data,this.form.id=a.id,this.form.code=a.code,this.form.customer_name=a.customer_name,this.form.customer_address=a.customer_address,this.form.setting_master_customer_id=a.setting_master_customer_id,a.customer_contacts[0]&&(this.form.customer_contacts=a.customer_contacts[0].value),this.form.customer_branch=a.customer_branch,t.next=17;break;case 14:throw t.prev=14,t.t0=t["catch"](0),t.t0;case 17:case"end":return t.stop()}}),t,this,[[0,14]])})));function e(){return t.apply(this,arguments)}return e}(),updateCustomer:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.$validator.validateAll();case 3:e=t.sent,e?this.$vs.dialog({type:"confirm",color:"success",title:"แก้ข้อมูลสำเร็จ",text:"แก้ไขข้อมูลสมาชิก  ".concat(this.form.customer_name),acceptText:"ยืนยัน",cancelText:"ยกเลิก",accept:this.acceptAlert}):this.$vs.dialog({color:"danger",title:"แก้ข้อมูลไม้สำเร็จ",text:"กรุณาตรวจสอบการกรอกข้อมูลให้ครบถ้วน",acceptText:"ปิด",accept:this.acceptAlertFail}),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),this.$vs.dialog({color:"danger",title:"แก้ข้อมูลไม้สำเร็จ",text:"กรุณาตรวจสอบการกรอกข้อมูลให้ครบถ้วน",acceptText:"ปิด",accept:this.acceptAlertFail});case 10:case"end":return t.stop()}}),t,this,[[0,7]])})));function e(){return t.apply(this,arguments)}return e}(),acceptAlert:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$http.patch("/api/customers/".concat(this.form.id),this.form);case 2:return e=t.sent,this.data_id=e.data.data.id,this.$refs.upload.id=e.data.data.id,t.next=7,this.$refs.upload.submit();case 7:a=t.sent,console.log(a),this.$router.push({name:"customer_index",query:{}}),this.$vs.notify({color:"success",title:"แก้ไขข้อมูล",text:"แก้ไขข้อมูลสมาชิกสำเร็จ"});case 11:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),acceptAlertFail:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.$vs.notify({color:"danger",title:"แก้ไขไม่สำเร็จข้อมูล",text:"แก้ไขข้อมูลสมาชิกไม่สำเร็จ"});case 1:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},mounted:function(){var t=this;this.form.id=this.$route.query.id,setTimeout((function(){t.loadData()}),0)}},v=m,h=Object(u["a"])(v,r,s,!1,null,null,null);e["default"]=h.exports}}]);
//# sourceMappingURL=chunk-2d2073e8.dee142a5.js.map